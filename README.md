# Excel数据可视化工具

一个交互式的Excel数据可视化工具，支持动态调整数值和实时排名计算。该工具可以读取Excel文件中的多准则决策分析(MCDA)数据，并提供交互式的数据调整和可视化功能。

## 功能特点

- **动态数据读取**：自动读取`data`文件夹下的所有Excel文件
- **交互式调整**：支持滑块和输入框实时调整数值
- **实时计算**：权重求和排名计算，结果实时更新
- **数据可视化**：图表展示数据变化和排名结果
- **数值锁定**：支持锁定特定数值，防止误操作
- **范围限制**：数值调整范围限制在0-100之间
- **多文件支持**：支持V6和V7版本的MCDA数据文件

## 系统要求

### 必需软件
- **Node.js** (版本 14.0 或更高)
  - 下载地址：https://nodejs.org/
  - 安装后可通过 `node --version` 验证安装
- **npm** (通常随Node.js一起安装)
  - 可通过 `npm --version` 验证安装

### 推荐软件
- **现代浏览器**：Chrome、Firefox、Safari、Edge
- **代码编辑器**：VS Code、Sublime Text等

## 安装步骤

### 1. 克隆或下载项目
```bash
# 如果使用Git
git clone [项目地址]
cd week8

# 或者直接下载项目文件到本地
```

### 2. 安装项目依赖
在项目根目录下运行：
```bash
npm install
```

这将安装以下依赖包：
- `express` (^4.18.2) - Web服务器框架
- `nodemon` (^3.0.1) - 开发模式自动重启工具

### 3. 验证安装
```bash
# 检查Node.js版本
node --version

# 检查npm版本
npm --version

# 检查项目依赖是否正确安装
npm list
```

## 运行应用

### 生产模式启动
```bash
npm start
```

### 开发模式启动（推荐）
```bash
npm run dev
```
开发模式会自动重启服务器，当代码发生变化时。

### 访问应用
启动成功后，在浏览器中打开：
```
http://localhost:3000
```

## 使用方法

### 1. 准备Excel文件
将Excel文件放入`data`文件夹中。文件格式要求：
- **A3行**：列名（指标名称）
- **第4行到倒数第二行**：数据行（各方案的指标值）
- **最后一行**：权重行（各指标的权重）
- **最后一列**：初始排名

### 2. 选择数据文件
- 页面会自动检测并列出所有可用的Excel文件
- 从下拉菜单中选择要分析的文件
- 系统会自动加载数据并显示初始状态

### 3. 交互式数据调整
- **滑块调整**：使用滑块调整各指标的权重
- **数值输入**：直接在输入框中输入具体数值
- **数值锁定**：点击锁定按钮防止特定数值被修改
- **实时更新**：所有调整都会实时反映在图表和排名中

### 4. 查看结果
- **排名变化**：观察调整后各方案的排名变化
- **图表可视化**：通过图表直观查看数据分布
- **权重影响**：分析不同权重设置对结果的影响

## 文件结构说明

```
week8/
├── index.html                    # 主页面文件
├── app.js                       # 前端应用逻辑（1953行）
├── server.js                    # Express服务器（34行）
├── package.json                 # 项目配置和依赖
├── README.md                    # 项目说明文档
├── data/                        # Excel数据文件目录
```

### 核心文件说明

- **index.html**：应用的主页面，包含HTML结构和基本样式
- **app.js**：前端JavaScript逻辑，包含数据处理、图表绘制、交互功能
- **server.js**：Express服务器，提供静态文件服务和API接口
- **package.json**：项目配置，定义依赖包和运行脚本

## 技术栈

- **前端**：原生JavaScript、D3.js、XLSX.js
- **后端**：Node.js、Express.js
- **样式**：Tailwind CSS

## 开发说明

### 修改代码
- 前端逻辑在 `app.js` 中
- 服务器配置在 `server.js` 中
- 样式可以通过修改HTML中的Tailwind类来调整

### 添加新功能
1. 修改 `app.js` 添加新功能
2. 如有需要，更新 `server.js` 添加新的API端点
3. 更新 `index.html` 添加新的UI元素
